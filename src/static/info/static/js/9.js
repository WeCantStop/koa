webpackJsonp([9],{BzfQ:function(e,t){},TI7Z:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("fZjL"),r=a.n(l),i=a("t5DY"),s=a("myXI"),o={data:function(){return{formValidate:{targetName:{required:!0,message:"请输入爬取目标名称",trigger:"blur"},targetUrl:{required:!0,message:"请输入爬取目标url",trigger:"blur"},targetType:{required:!0,message:"请输入目标类型",trigger:"blur"},directoryId:{required:!0,message:"请输入栏目编号",trigger:"blur"}},options1:[{value:"search",label:"搜索"},{value:"list",label:"列表"},{value:"article",label:"内容"}],options2:[{value:"1",label:"抓取"},{value:"0",label:"不抓取"}],labelIdValue:[],editTargetId:null,subForm:{targetName:"",targetUrl:"",targetType:"",hasNext:"",labelIdList:"",directoryId:""},dialogVisiblePage:!1,tagOptions:[],colmnOptions:[],list:[],total:1,pageNum:1,pageSize:10}},mounted:function(){this.getOption(),this.getColumn(),this.getList()},methods:{getColumn:function(){var e=this;Object(i.a)(s.listInfoDirectory,{pageNum:1,pageSize:50}).then(function(t){"200"===t.returnCode&&(e.colmnOptions=e.formateCate2(t.result))})},getOption:function(){var e=this;Object(i.a)(s.getLabels).then(function(t){"200"===t.returnCode&&(e.tagOptions=e.formateCate(t.result),e.cate=e.tagOptions[0].value)})},formateCate2:function(e){var t=[];return e.forEach(function(e){var a={value:e.id,label:e.directoryName};t.push(a)}),t},formateCate:function(e){var t=[];return e.forEach(function(e){var a={value:e.id,label:e.labelName};t.push(a)}),t},getList:function(){var e=this;Object(i.a)(s.pageCrawlerList,{pageNum:this.pageNum,pageSize:this.pageSize}).then(function(t){"200"===t.returnCode&&(e.list=t.result.list,e.total=t.result.total)})},saveTarget:function(){var e=this,t=!1;if(this.$refs.form.validate(function(e){console.log(e),e&&(t=!0)}),!t)return!1;var a=this.subForm;a.labelIdList=this.labelIdValue.join(","),this.editTargetId?this.updateTarget(a):Object(i.a)(s.saveCrawler,a).then(function(t){"200"===t.returnCode&&(e.cancelDialog(),e.getList(),e.$message({message:t.returnMsg,type:"success"}))})},editTarget:function(e){var t=this;Object(i.a)(s.getCrawlerDetail,{id:e.id}).then(function(e){if("200"===e.returnCode){var a=e.result;r()(t.subForm).forEach(function(e){t.subForm[e]=a[e]});var l=a.labelIds.split(",");t.labelIdValue=l.map(function(e){return parseInt(e)}),t.openDialog(),t.editTargetId=a.id}})},updateTarget:function(e){var t=this;e.crawlerTargetId=this.editTargetId,Object(i.a)(s.updateCrawler,e).then(function(e){"200"===e.returnCode&&(t.cancelDialog(),t.getList(),t.$message({message:e.returnMsg,type:"success"}))})},deleteTarget:function(e){var t=this;this.$confirm("确定删除选中记录么?","提示",{}).then(function(){Object(i.a)(s.deleteCrawler,{crawlerTargetId:e.id}).then(function(e){"200"===e.returnCode&&(t.cancelDialog(),t.getList(),t.$message({message:e.returnMsg,type:"success"}))})}).catch(function(){})},dowork:function(e){var t=this,a={targetId:e.id};Object(i.a)(s.doCrawler,a).then(function(e){"200"===e.returnCode&&t.getList(),t.$message({message:e.returnMsg,type:"success"})})},changePage:function(e){this.pageNum=e.page,this.pageSize=e.rows||10,this.getList()},addNewTarget:function(){this.editTargetId=null,this.subForm={targetName:"",targetUrl:"",targetType:"",hasNext:"",labelIdList:"",directoryId:""},this.labelIdValue=[],this.openDialog()},hideDialog:function(){this.$refs.form.clearValidate()},openDialog:function(){this.dialogVisiblePage=!0},cancelDialog:function(){this.dialogVisiblePage=!1},handleSelectionChange:function(e){this.selectionRowData=e}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("za-page-content",{attrs:{header:"爬虫目标管理"}},[a("za-table",{ref:"table",attrs:{data:e.list,"highlight-current-row":"",total:e.total},on:{"action-change":e.changePage,"selection-change":e.handleSelectionChange}},[a("el-row",{staticClass:"targetTit",attrs:{slot:"searchBar"},slot:"searchBar"},[a("el-button",{attrs:{size:"medium",type:"success"},on:{click:e.addNewTarget}},[e._v("添加爬虫目标")])],1),e._v(" "),a("el-table-column",{attrs:{prop:"targetUrl",label:"爬取目标"}}),e._v(" "),a("el-table-column",{attrs:{label:"爬取标签",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.labelList,function(t,l){return a("span",{key:l},[e._v(e._s(t.labelName)+",")])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.dowork(t.row)}}},[e._v("立即爬取")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.editTarget(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteTarget(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加爬虫目标",visible:e.dialogVisiblePage,width:"40%"},on:{"update:visible":function(t){e.dialogVisiblePage=t},close:e.hideDialog}},[a("el-row",[a("el-form",{ref:"form",attrs:{model:e.subForm,rules:e.formValidate,"label-position":"left","label-width":"120px"}},[a("el-row",[a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"目标名称",prop:"targetName"}},[a("el-col",{attrs:{span:20}},[a("el-input",{model:{value:e.subForm.targetName,callback:function(t){e.$set(e.subForm,"targetName",t)},expression:"subForm.targetName"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"目标url",prop:"targetUrl"}},[a("el-col",{attrs:{span:20}},[a("el-input",{model:{value:e.subForm.targetUrl,callback:function(t){e.$set(e.subForm,"targetUrl",t)},expression:"subForm.targetUrl"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"目标类型",prop:"targetType"}},[a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.subForm.targetType,callback:function(t){e.$set(e.subForm,"targetType",t)},expression:"subForm.targetType"}},e._l(e.options1,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"抓取下一页",prop:"hasNext"}},[a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.subForm.hasNext,callback:function(t){e.$set(e.subForm,"hasNext",t)},expression:"subForm.hasNext"}},e._l(e.options2,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"标签",prop:"labelIdValue"}},[a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择"},model:{value:e.labelIdValue,callback:function(t){e.labelIdValue=t},expression:"labelIdValue"}},e._l(e.tagOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"栏目编号",prop:"directoryId"}},[a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.subForm.directoryId,callback:function(t){e.$set(e.subForm,"directoryId",t)},expression:"subForm.directoryId"}},e._l(e.colmnOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",staticStyle:{"margin-top":"30px"}},[a("el-button",{on:{click:e.cancelDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveTarget}},[e._v("确 定")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(o,n,!1,function(e){a("BzfQ")},"data-v-a8ecf63a",null);t.default=u.exports}});
//# sourceMappingURL=9.js.map