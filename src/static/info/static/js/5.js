webpackJsonp([5],{j7HV:function(t,e){},lJB8:function(t,e){},prE0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),l=a.n(i),s=a("mvHQ"),r=a.n(s),n=a("t5DY"),o=a("myXI"),c=a("PJh5"),u=a.n(c),p={data:function(){return{ajaxUrl:o,dialogTitle:"新建组件",showDialog:!1,unitData:{},formValidate:{name:{required:!0,message:"请输入组件名称",trigger:"blur"},type:{required:!0,message:"请选择组件类型",trigger:"blur"},isOpenReward:{required:!0,message:"请选择是否开启积分奖励",trigger:"blur"},timeRange:{required:!0,message:"请选择有效期",trigger:"blur"},coverImage:{required:!0,message:"请上传活动配图",trigger:"blur"},selectA:{required:!0,message:"请填写选项A",trigger:"blur"},selectB:{required:!0,message:"请填写选项B",trigger:"blur"},initA:{required:!0,message:"请填写初始票数",trigger:"blur"},initB:{required:!0,message:"请填写初始票数",trigger:"blur"}}}},methods:{show:function(t){this.unitData=this.parseData(t)||{coverImage:""},this.showDialog=!0},parseData:function(t){if(!t)return this.dialogTitle="新建组件",!1;this.dialogTitle="编辑组件";var e="YYYY-MM-DD HH:mm:ss",a=[u()(t.gmtValidityStart).format(e),u()(t.gmtValidityEnd).format(e)];return l()({},t,JSON.parse(t.extraInfo),{timeRange:a})},hide:function(){this.$refs.form.clearValidate(),this.showDialog=!1},handleAvatarSuccess:function(t){this.unitData.coverImage=t.result},validate:function(){var t=!1;return this.$refs.form.validate(function(e){e&&(t=!0)}),t},submit:function(){var t=this;if(!this.validate())return!1;var e=this.unitData;e.extraInfo=r()({selectA:e.selectA,initA:e.initA,selectB:e.selectB,initB:e.initB}),e.gmtValidityStart=e.timeRange[0],e.gmtValidityEnd=e.timeRange[1],Object(n.a)(o.saveOrUpdateUnit,e).then(function(e){"200"===e.returnCode?(t.$emit("submitUnit"),t.hide(),t.$message({showClose:!0,message:"保存成功",type:"success"})):t.$message({showClose:!0,message:e.returnMsg,type:"error"})})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-unit-dialog"},[a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.showDialog,width:"680px",top:"5vh"},on:{"update:visible":function(e){t.showDialog=e},close:t.hide}},[a("el-form",{ref:"form",attrs:{model:t.unitData,rules:t.formValidate,"label-position":"left","label-width":"110px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:23}},[a("span",{staticClass:"title-tip"},[t._v("注: 最多40个字")]),t._v(" "),a("el-form-item",{attrs:{label:"组件名称:",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入组件名称"},model:{value:t.unitData.name,callback:function(e){t.$set(t.unitData,"name",e)},expression:"unitData.name"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组件类型:",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择组件类型"},model:{value:t.unitData.type,callback:function(e){t.$set(t.unitData,"type",e)},expression:"unitData.type"}},[a("el-option",{attrs:{label:"PK组件",value:"01"}})],1)],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"开启积分奖励:",prop:"isOpenReward"}},[a("el-select",{attrs:{disabled:"编辑组件"===t.dialogTitle,placeholder:"是否开启积分奖励"},model:{value:t.unitData.isOpenReward,callback:function(e){t.$set(t.unitData,"isOpenReward",e)},expression:"unitData.isOpenReward"}},[a("el-option",{attrs:{label:"是",value:"01"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"02"}})],1)],1)],1),t._v(" "),"01"===t.unitData.isOpenReward?a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"投票所需积分:"}},[a("el-input",{attrs:{disabled:"编辑组件"===t.dialogTitle,type:"number"},model:{value:t.unitData.costPoint,callback:function(e){t.$set(t.unitData,"costPoint",e)},expression:"unitData.costPoint"}})],1)],1):t._e()],1),t._v(" "),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"有效期:",prop:"timeRange"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:t.unitData.timeRange,callback:function(e){t.$set(t.unitData,"timeRange",e)},expression:"unitData.timeRange"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"活动配图:",prop:"coverImage"}},[a("div",{staticClass:"img-tip",staticStyle:{color:"red"}},[t._v("* 建议宽高比690:180")]),t._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.ajaxUrl.baseUrl+t.ajaxUrl.uploadArticleImage,"show-file-list":!1,"on-success":t.handleAvatarSuccess}},[t.unitData.coverImage?a("img",{staticClass:"avatar",attrs:{src:t.unitData.coverImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选项A:",prop:"selectA"}},[a("el-input",{model:{value:t.unitData.selectA,callback:function(e){t.$set(t.unitData,"selectA",e)},expression:"unitData.selectA"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"初始票数:",prop:"initA"}},[a("el-input",{attrs:{type:"number"},model:{value:t.unitData.initA,callback:function(e){t.$set(t.unitData,"initA",e)},expression:"unitData.initA"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选项B:",prop:"selectB"}},[a("el-input",{model:{value:t.unitData.selectB,callback:function(e){t.$set(t.unitData,"selectB",e)},expression:"unitData.selectB"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"初始票数:",prop:"initB"}},[a("el-input",{attrs:{type:"number"},model:{value:t.unitData.initB,callback:function(e){t.$set(t.unitData,"initB",e)},expression:"unitData.initB"}})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"center"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(p,d,!1,function(t){a("lJB8")},null,null).exports,g=a("xVjy"),f={components:{EditUnit:m},data:function(){return{showdalog:!1,filters:{id:"",name:"",type:"",status:""},accounts:[],pageConfig:{pageNum:1,pageSize:10,total:1},formValidate:{type:[{required:!0,message:"请选择所属栏目",trigger:"blur"}],nickName:[{required:!0,message:"请输入昵称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}],level:[{required:!0,message:"请选择等级",trigger:"blur"}]}}},methods:{filter:function(){var t=this.filters.timeRange?this.filters.timeRange[0]:"",e=this.filters.timeRange?this.filters.timeRange[1]:"";this.pageConfig=l()({},this.pageConfig,this.filters,{gmtCreatedStart:t,gmtCreatedEnd:e,pageNum:1}),this.$refs.table.resetCurrentPage()||this.initData()},initData:function(){var t=this;this.loadingTable=!0,Object(n.a)(o.getUnitList,l()({},this.pageConfig)).then(function(e){setTimeout(function(){t.accounts=e.result.list,t.pageConfig.total=e.result.total,t.loadingTable=!1},200)})},createUnit:function(){this.$refs.editUnit.show()},batchOnlineOrOffLine:function(t,e,a){var i=this;Object(n.a)(o.onlineOrOfLine,{id:a.id,status:t}).then(function(t){var e={};e="200"===t.returnCode?{showClose:!0,message:"成功",type:"success"}:{showClose:!0,message:t.returnMessage,type:"error"},i.$message(e),i.initData()})},handleEditUnit:function(t){this.$refs.editUnit.show(t)},handleDelUnit:function(t){var e=this;this.$confirm("确定删除该组件?","提示",{}).then(function(){Object(n.a)(o.delUnit,{id:t}).then(function(t){e.initData(),e.$message({showClose:!0,message:"删除成功",type:"success"})})})},handleSelectionChange:function(t){this.selectionRowData=t},formatterDate:function(t,e,a){return Object(g.a)(a)},changePage:function(t){var e={pageNum:t.page,pageSize:t.rows||this.pageConfig.pageSize};this.pageConfig=l()({},this.pageConfig,e),this.initData()}},created:function(){this.initData()}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("za-page-content",{attrs:{scroll:"true"}},[a("za-table",{ref:"table",attrs:{data:t.accounts,total:t.pageConfig.total,isLoading:t.loadingTable},on:{"selection-change":t.handleSelectionChange,"action-change":t.changePage}},[a("div",{staticStyle:{"padding-bottom":"0px"},attrs:{slot:"searchBar"},slot:"searchBar"},[a("el-form",{ref:"filtersForm",attrs:{model:t.filters}},[a("el-form-item",[a("el-col",{attrs:{span:8}},[a("el-col",{attrs:{span:6}},[t._v("组件ID:")]),t._v(" "),a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{clearable:!0,placeholder:"组件ID"},model:{value:t.filters.id,callback:function(e){t.$set(t.filters,"id",e)},expression:"filters.id"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-col",{attrs:{span:6,offset:1}},[t._v("组件名称:")]),t._v(" "),a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{clearable:!0,placeholder:"组件名称"},model:{value:t.filters.name,callback:function(e){t.$set(t.filters,"name",e)},expression:"filters.name"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-col",{attrs:{span:6,offset:2}},[t._v("状态:")]),t._v(" "),a("el-col",{attrs:{span:14}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择状态"},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}},[a("el-option",{attrs:{label:"生效",value:"01"}}),t._v(" "),a("el-option",{attrs:{label:"失效",value:"02"}})],1)],1)],1)],1),t._v(" "),a("el-form-item",[a("el-col",{attrs:{span:16}},[a("el-col",{attrs:{span:3}},[t._v("创建时间:")]),t._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:t.filters.timeRange,callback:function(e){t.$set(t.filters,"timeRange",e)},expression:"filters.timeRange"}})],1),t._v(" "),a("el-col",{attrs:{span:8,align:"center"}},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:t.filter}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.createUnit}},[t._v("新建组件")])],1)],1)],1)],1),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"组件ID",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"组件类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s("01"===e.row.type?"PK组件":"其他组件")+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"组件名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"gmtCreated",label:"创建时间",formatter:t.formatterDate,width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s("01"===e.row.status?"生效":"失效")+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.handleEditUnit(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDelUnit(e.row.id)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("EditUnit",{ref:"editUnit",on:{submitUnit:t.initData}})],1)},staticRenderFns:[]};var h=a("VU/8")(f,v,!1,function(t){a("j7HV")},"data-v-fb09b858",null);e.default=h.exports}});
//# sourceMappingURL=5.js.map